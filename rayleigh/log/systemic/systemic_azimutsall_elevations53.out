Correct input file in use: systemic/systemic_azimutsall_elevations53
All input parameter from the input file:
path: /home/bossel/These/Analysis/data/Night_pollution/
src_path: /home/bossel/These/Analysis/src/rayleigh/
saving_graphs: 0
save_path: /home/bossel/These/Documentation/Mes_articles/auroral_pola/sky_only/
save_name: 20190307_m_sky_only_aero_1low_albedo
flux_unit: W
use_analytic: false
azimuts: all
elevations: 53
location: skibotn
start_datetime: 20190116-02:44:00
end_datetime: 20190116-04:00:00
instrument_opening_angle: 1
instrument_area: 20
wavelength: 557.7
cst_Flux: 0
cst_DoLP: 0
cst_AoLP: 0
add_starlight: 0
add_B_pola: 0
RS_min_altitude: 0
RS_max_altitude: 100
Nb_points_along_los: 100
resolution_along_los: 0.5
max_angle_discretization: 0
Atmospheric_profile: atm_profiles/win.atm
use_ozone: 1
use_aerosol: 1
aer_complexity: 1
aer_model: maritime
aer_name: maritime_test
aer_nr: 1.6
aer_ni: -0.010
aer_rn0: 1
aer_rmg: 0.001
aer_ln_sigma: 0.657
aer_r_min: 0.001
aer_r_max: 50
aer_Hn: 0.440
aer_n0: 300
aer_nBK: 30
aer_ext_profile_name: mar
aer_single_scatter_albedo: 0.9
aer_phase_fct_asym_g: 0.7
sky_mode: image
direct_mode: only
emission_altitude: 110
Nb_emission_points: 1000
Nb_emission_maps: 1
I_zone_a_min: 0
I_zone_a_max: 360
I_zone_e_min: 0
I_zone_e_max: 90
sky_path: /home/bossel/These/Analysis/data/allsky_camera/tid.uio.no/plasma/aurora/
sky_file: skn4/5577/2019/20190308/ut01/skn4_20190308_012908_5577_cal.png
sky_wavelength: 557.7
use_alt_map: 1
alt_map_path: /home/bossel/These/Analysis/data/elevation/
alt_map_radius: 100
alt_map_N_bins_max: 0
alt_map_resolution: 0.5
ground_mode: none
shader_mode: none
ground_emission_radius: 100
ground_N_bins_max: 1000
ground_albedo: altitude_0.2_0.2_0.5_0.5_0.8
ground_path: /home/bossel/These/Analysis/data/Night_pollution/
ground_file: nighttime_light_files/SVDNB_npp_20160101-20161231_75N060W_vcm-orm-ntl_v10_c201807311200.avg_rade9.tif
Aerosol Model: maritime
Running aerosol optical properties. May take 10sec...
Loading the sky emission cube...
Importing all sky image data from: /home/bossel/These/Analysis/data/allsky_camera/tid.uio.no/plasma/aurora/skn4/5577/2019/20190308/ut01/skn4_20190308_012908_5577_cal.png
Sky cube loaded!
Has_sky_emission: True
Has_ground_emission: False
ALT MAP RESOLUTION lon, lat 0.5 1.417681295118693 0.49999999999999994
WARNING: Elevation tile not found: /home/bossel/These/Analysis/data/elevation/N070E015_N075E020/ALPSMLC30_N070E017_DSM.tif
WARNING: Elevation tile not found: /home/bossel/These/Analysis/data/elevation/N070E015_N075E020/ALPSMLC30_N070E018_DSM.tif
WARNING: Elevation tile not found: /home/bossel/These/Analysis/data/elevation/N070E015_N075E020/ALPSMLC30_N070E019_DSM.tif
Initialization DONE
*******************************************************************************************************************************
Starting calculation for SKY map 1/36:
Observation at point (20.363641, 69.348151), azimuth 0.0, elevation 53.0. Observed point at altitude 110.0, position (20.363641, 70.07747542908399)
Starting time:  11:40:42
Computing DONE in:  0:00:00.000039
*******************************************************************************************************************************
Starting calculation for SKY map 2/36:
Observation at point (20.363641, 69.348151), azimuth 10.0, elevation 53.0. Observed point at altitude 110.0, position (20.735097356188327, 70.06601059541255)
Starting time:  11:40:42
Computing DONE in:  0:00:00.000020
*******************************************************************************************************************************
Starting calculation for SKY map 3/36:
Observation at point (20.363641, 69.348151), azimuth 20.0, elevation 53.0. Observed point at altitude 110.0, position (21.094086516688463, 70.03200166902863)
Starting time:  11:40:42
Computing DONE in:  0:00:00.000018
*******************************************************************************************************************************
Starting calculation for SKY map 4/36:
Observation at point (20.363641, 69.348151), azimuth 29.999999999999996, elevation 53.0. Observed point at altitude 110.0, position (21.428679033631113, 69.97658856457595)
Starting time:  11:40:42
Computing DONE in:  0:00:00.000018
*******************************************************************************************************************************
Starting calculation for SKY map 5/36:
Observation at point (20.363641, 69.348151), azimuth 40.0, elevation 53.0. Observed point at altitude 110.0, position (21.72798050627641, 69.90161641723822)
Starting time:  11:40:42
Computing DONE in:  0:00:00.000021
*******************************************************************************************************************************
Starting calculation for SKY map 6/36:
Observation at point (20.363641, 69.348151), azimuth 50.0, elevation 53.0. Observed point at altitude 110.0, position (21.982553708249927, 69.80955788167196)
Starting time:  11:40:42
Computing DONE in:  0:00:00.000043
*******************************************************************************************************************************
Starting calculation for SKY map 7/36:
Observation at point (20.363641, 69.348151), azimuth 59.99999999999999, elevation 53.0. Observed point at altitude 110.0, position (22.184740982919287, 69.70341245697392)
Starting time:  11:40:42
Computing DONE in:  0:00:00.000023
*******************************************************************************************************************************
Starting calculation for SKY map 8/36:
Observation at point (20.363641, 69.348151), azimuth 70.0, elevation 53.0. Observed point at altitude 110.0, position (22.328874787773305, 69.5865895631465)
Starting time:  11:40:42
Computing DONE in:  0:00:00.000022
*******************************************************************************************************************************
Starting calculation for SKY map 9/36:
Observation at point (20.363641, 69.348151), azimuth 80.0, elevation 53.0. Observed point at altitude 110.0, position (22.411376594325212, 69.4627823940478)
Starting time:  11:40:42
Computing DONE in:  0:00:00.000024
*******************************************************************************************************************************
Starting calculation for SKY map 10/36:
Observation at point (20.363641, 69.348151), azimuth 90.0, elevation 53.0. Observed point at altitude 110.0, position (22.430754566068728, 69.33583914754537)
Starting time:  11:40:42
Computing DONE in:  0:00:00.000019
*******************************************************************************************************************************
Starting calculation for SKY map 11/36:
Observation at point (20.363641, 69.348151), azimuth 100.0, elevation 53.0. Observed point at altitude 110.0, position (22.38751734533491, 69.20963728386249)
Starting time:  11:40:42
Computing DONE in:  0:00:00.000020
*******************************************************************************************************************************
Starting calculation for SKY map 12/36:
Observation at point (20.363641, 69.348151), azimuth 110.0, elevation 53.0. Observed point at altitude 110.0, position (22.28402457061291, 69.08796522708738)
Starting time:  11:40:42
Computing DONE in:  0:00:00.000023
*******************************************************************************************************************************
Starting calculation for SKY map 13/36:
Observation at point (20.363641, 69.348151), azimuth 119.99999999999999, elevation 53.0. Observed point at altitude 110.0, position (22.124294831851696, 68.9744146260505)
Starting time:  11:40:42
Computing DONE in:  0:00:00.000019
*******************************************************************************************************************************
Starting calculation for SKY map 14/36:
Observation at point (20.363641, 69.348151), azimuth 130.0, elevation 53.0. Observed point at altitude 110.0, position (21.913789490768377, 68.87228510053723)
Starting time:  11:40:42
Computing DONE in:  0:00:00.000019
*******************************************************************************************************************************
Starting calculation for SKY map 15/36:
Observation at point (20.363641, 69.348151), azimuth 140.0, elevation 53.0. Observed point at altitude 110.0, position (21.65918710831918, 68.7845024223402)
Starting time:  11:40:42
Computing DONE in:  0:00:00.000019
*******************************************************************************************************************************
Starting calculation for SKY map 16/36:
Observation at point (20.363641, 69.348151), azimuth 150.0, elevation 53.0. Observed point at altitude 110.0, position (21.368158994956993, 68.71355036173878)
Starting time:  11:40:42
Computing DONE in:  0:00:00.000018
*******************************************************************************************************************************
Starting calculation for SKY map 17/36:
Observation at point (20.363641, 69.348151), azimuth 160.0, elevation 53.0. Observed point at altitude 110.0, position (21.049152277557766, 68.66141596578503)
Starting time:  11:40:42
Computing DONE in:  0:00:00.000042
*******************************************************************************************************************************
Starting calculation for SKY map 18/36:
Observation at point (20.363641, 69.348151), azimuth 170.0, elevation 53.0. Observed point at altitude 110.0, position (20.7111832657034, 68.62954779361108)
Starting time:  11:40:42
Computing DONE in:  0:00:00.000023
*******************************************************************************************************************************
Starting calculation for SKY map 19/36:
Observation at point (20.363641, 69.348151), azimuth 180.0, elevation 53.0. Observed point at altitude 110.0, position (20.363641, 68.618826570916)
Starting time:  11:40:42
Computing DONE in:  0:00:00.000019
*******************************************************************************************************************************
Starting calculation for SKY map 20/36:
Observation at point (20.363641, 69.348151), azimuth 190.0, elevation 53.0. Observed point at altitude 110.0, position (20.016098734296598, 68.62954779361108)
Starting time:  11:40:42
Computing DONE in:  0:00:00.000019
*******************************************************************************************************************************
Starting calculation for SKY map 21/36:
Observation at point (20.363641, 69.348151), azimuth 200.0, elevation 53.0. Observed point at altitude 110.0, position (19.67812972244223, 68.66141596578503)
Starting time:  11:40:42
Computing DONE in:  0:00:00.000019
*******************************************************************************************************************************
Starting calculation for SKY map 22/36:
Observation at point (20.363641, 69.348151), azimuth 210.00000000000003, elevation 53.0. Observed point at altitude 110.0, position (19.359123005043006, 68.71355036173878)
Starting time:  11:40:42
Computing DONE in:  0:00:00.000032
*******************************************************************************************************************************
Starting calculation for SKY map 23/36:
Observation at point (20.363641, 69.348151), azimuth 220.0, elevation 53.0. Observed point at altitude 110.0, position (19.068094891680822, 68.7845024223402)
Starting time:  11:40:42
Computing DONE in:  0:00:00.000032
*******************************************************************************************************************************
Starting calculation for SKY map 24/36:
Observation at point (20.363641, 69.348151), azimuth 230.0, elevation 53.0. Observed point at altitude 110.0, position (18.813492509231626, 68.87228510053723)
Starting time:  11:40:42
Computing DONE in:  0:00:00.000024
*******************************************************************************************************************************
Starting calculation for SKY map 25/36:
Observation at point (20.363641, 69.348151), azimuth 239.99999999999997, elevation 53.0. Observed point at altitude 110.0, position (18.602987168148303, 68.9744146260505)
Starting time:  11:40:42
Computing DONE in:  0:00:00.000019
*******************************************************************************************************************************
Starting calculation for SKY map 26/36:
Observation at point (20.363641, 69.348151), azimuth 250.00000000000003, elevation 53.0. Observed point at altitude 110.0, position (18.44325742938709, 69.08796522708738)
Starting time:  11:40:42
Computing DONE in:  0:00:00.000019
*******************************************************************************************************************************
Starting calculation for SKY map 27/36:
Observation at point (20.363641, 69.348151), azimuth 260.0, elevation 53.0. Observed point at altitude 110.0, position (18.339764654665093, 69.20963728386249)
Starting time:  11:40:42
Computing DONE in:  0:00:00.000018
*******************************************************************************************************************************
Starting calculation for SKY map 28/36:
Observation at point (20.363641, 69.348151), azimuth 270.0, elevation 53.0. Observed point at altitude 110.0, position (18.296527433931267, 69.33583914754537)
Starting time:  11:40:42
Computing DONE in:  0:00:00.000020
*******************************************************************************************************************************
Starting calculation for SKY map 29/36:
Observation at point (20.363641, 69.348151), azimuth 280.0, elevation 53.0. Observed point at altitude 110.0, position (18.315905405674787, 69.4627823940478)
Starting time:  11:40:42
Computing DONE in:  0:00:00.000018
*******************************************************************************************************************************
Starting calculation for SKY map 30/36:
Observation at point (20.363641, 69.348151), azimuth 290.0, elevation 53.0. Observed point at altitude 110.0, position (18.398407212226697, 69.5865895631465)
Starting time:  11:40:42
Computing DONE in:  0:00:00.000018
*******************************************************************************************************************************
Starting calculation for SKY map 31/36:
Observation at point (20.363641, 69.348151), azimuth 300.0, elevation 53.0. Observed point at altitude 110.0, position (18.542541017080712, 69.70341245697392)
Starting time:  11:40:42
Computing DONE in:  0:00:00.000018
*******************************************************************************************************************************
Starting calculation for SKY map 32/36:
Observation at point (20.363641, 69.348151), azimuth 310.0, elevation 53.0. Observed point at altitude 110.0, position (18.744728291750068, 69.80955788167196)
Starting time:  11:40:42
Computing DONE in:  0:00:00.000020
*******************************************************************************************************************************
Starting calculation for SKY map 33/36:
Observation at point (20.363641, 69.348151), azimuth 320.0, elevation 53.0. Observed point at altitude 110.0, position (18.99930149372359, 69.90161641723822)
Starting time:  11:40:42
Computing DONE in:  0:00:00.000024
*******************************************************************************************************************************
Starting calculation for SKY map 34/36:
Observation at point (20.363641, 69.348151), azimuth 330.0, elevation 53.0. Observed point at altitude 110.0, position (19.298602966368883, 69.97658856457595)
Starting time:  11:40:42
Computing DONE in:  0:00:00.000021
*******************************************************************************************************************************
Starting calculation for SKY map 35/36:
Observation at point (20.363641, 69.348151), azimuth 340.0, elevation 53.0. Observed point at altitude 110.0, position (19.633195483311535, 70.03200166902863)
Starting time:  11:40:42
Computing DONE in:  0:00:00.000020
*******************************************************************************************************************************
Starting calculation for SKY map 36/36:
Observation at point (20.363641, 69.348151), azimuth 350.0, elevation 53.0. Observed point at altitude 110.0, position (19.992184643811672, 70.06601059541255)
Starting time:  11:40:42
Computing DONE in:  0:00:00.000058
Stacking processor results...
opt_depth, direct:
0.16278481894988564 4.144031492724806e-12
/usr/lib/python3/dist-packages/numpy/lib/histograms.py:908: RuntimeWarning: invalid value encountered in true_divide
  return n/db/n.sum(), bin_edges
opt_depth, direct:
0.16278481894988564 3.937637949335373e-12
opt_depth, direct:
0.16278481894988564 3.799210751847117e-12
opt_depth, direct:
0.16278481894988564 3.804626278105197e-12
opt_depth, direct:
0.16278481894988564 4.206692979624097e-12
opt_depth, direct:
0.16278481894988564 4.359175829800484e-12
opt_depth, direct:
0.16278481894988564 4.616159029921275e-12
opt_depth, direct:
0.16278481894988564 4.159644989265413e-12
opt_depth, direct:
0.16278481894988564 3.835709952769268e-12
opt_depth, direct:
0.16278481894988564 3.008807378833602e-12
opt_depth, direct:
0.16278481894988564 2.4927717607560766e-12
opt_depth, direct:
0.16278481894988564 2.077807517180193e-12
opt_depth, direct:
0.16278481894988564 1.5661420282649023e-12
opt_depth, direct:
0.16278481894988564 1.2651942520445005e-12
opt_depth, direct:
0.16278481894988564 1.032937116365758e-12
opt_depth, direct:
0.16278481894988564 8.369018267794969e-13
opt_depth, direct:
0.16278481894988564 7.305433710426796e-13
opt_depth, direct:
0.16278481894988564 8.563469250293819e-13
opt_depth, direct:
0.16278481894988564 7.392827913034083e-13
opt_depth, direct:
0.16278481894988564 7.274150566526248e-13
opt_depth, direct:
0.16278481894988564 7.098816179341846e-13
opt_depth, direct:
0.16278481894988564 6.929449038620792e-13
opt_depth, direct:
0.16278481894988564 7.433531140689197e-13
opt_depth, direct:
0.16278481894988564 7.434258970608315e-13
opt_depth, direct:
0.16278481894988564 7.986971750669022e-13
opt_depth, direct:
0.16278481894988564 8.062116370647276e-13
opt_depth, direct:
0.16278481894988564 9.25799420950681e-13
opt_depth, direct:
0.16278481894988564 1.1065585742829609e-12
opt_depth, direct:
0.16278481894988564 1.2904134192523586e-12
opt_depth, direct:
0.16278481894988564 1.6520598552771044e-12
opt_depth, direct:
0.16278481894988564 2.0594195995837713e-12
opt_depth, direct:
0.16278481894988564 3.0896044175966368e-12
opt_depth, direct:
0.16278481894988564 3.4318218113549377e-12
opt_depth, direct:
0.16278481894988564 3.8798934389078314e-12
opt_depth, direct:
0.16278481894988564 4.462012846644931e-12
opt_depth, direct:
0.16278481894988564 4.280573754081182e-12
/home/bossel/These/Analysis/src/rayleigh/simulation.py:625: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  f, axs = plt.subplots(3, sharex = True, figsize=(16, 8))
Print results in log/20190307_v_rot_elevation_test.csv
Simulation ran in: 0:00:28.673843
