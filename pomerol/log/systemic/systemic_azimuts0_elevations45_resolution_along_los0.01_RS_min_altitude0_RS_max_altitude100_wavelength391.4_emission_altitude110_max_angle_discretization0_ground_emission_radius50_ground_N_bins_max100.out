Correct input file in use: systemic/systemic_azimuts0_elevations45_resolution_along_los0.01_RS_min_altitude0_RS_max_altitude100_wavelength391.4_emission_altitude110_max_angle_discretization0_ground_emission_radius50_ground_N_bins_max100
All input parameter from the input file:
path: /home/bossel/These/Analysis/data/Night_pollution/
src_path: /home/bossel/These/Analysis/src/rayleigh/
saving_graphs: 0
flux_unit: W
azimuts: 0
elevations: 45
location: lagorge
instrument_opening_angle: 1
instrument_area: 20
wavelength: 391.4
RS_min_altitude: 0
RS_max_altitude: 100
resolution_along_los: 0.01
max_angle_discretization: 0
Atmospheric_profile: atm_profiles/win.atm
sky_mode: none
emission_altitude: 110
Nb_emission_points: 500
Nb_emission_maps: 1
I_zone_a_min: 0
I_zone_a_max: 360
I_zone_e_min: 0
I_zone_e_max: 90
sky_path: /home/bossel/These/Analysis/data/allsky_camera/tid.uio.no/plasma/aurora/
sky_file: skn4/5577/2019/20190307/ut20/
sky_wavelength: 557.7
use_alt_map: 0
alt_map_path: /home/bossel/These/Analysis/data/elevation/
alt_map_radius: 50
alt_map_N_bins_max: 10000
alt_map_resolution: 0.2
ground_mode: point_I100_a180_d5
shader_mode: none
ground_emission_radius: 50
ground_N_bins_max: 100
ground_albedo: 0
ground_path: /home/bossel/These/Analysis/data/Night_pollution/
ground_file: nighttime_light_files/SVDNB_npp_20160101-20161231_75N060W_vcm-orm_v10_c201807311200.avg_rade9.tif
Has_sky_emission: False
Has_ground_emission: True
Initialization DONE
*******************************************************************************************************************************
STARTING calculation for GROUND map 1/1:
Observation at point (5.936935, 45.212343), azimuth 0.0, elevation 45.0. Observed point at altitude 110.0, position (5.936934999999999, 46.1767277912057)
Starting time:  10:57:44
14142.0 bins to compute per processor
Traceback (most recent call last):
  File "./systematic.py", line 349, in <module>
    RunSystematicSimulation()
  File "./systematic.py", line 334, in RunSystematicSimulation
    RunSimulation(file_name, show = False, output_result_file = "log/systematic_results.csv", header = not bool(count))
  File "/home/bossel/These/Analysis/src/rayleigh/main.py", line 53, in RunSimulation
    simu.ComputeAllMaps()
  File "/home/bossel/These/Analysis/src/rayleigh/simulation.py", line 127, in ComputeAllMaps
    self.SingleComputation()
  File "/home/bossel/These/Analysis/src/rayleigh/simulation.py", line 151, in SingleComputation
    self.ComputeMaps()
  File "/home/bossel/These/Analysis/src/rayleigh/simulation.py", line 248, in ComputeMaps
    self.world.ComputeGroundMaps(self.time, self.ia_pc, self.ie_pc)
  File "/home/bossel/These/Analysis/src/rayleigh/world.py", line 317, in ComputeGroundMaps
    V, Vcos, Vsin = self.ComputeSingleRSGroundPointSource(time, iaz, idist, a_rd, e_rd, sca_alt)
  File "/home/bossel/These/Analysis/src/rayleigh/world.py", line 365, in ComputeSingleRSGroundPointSource
    geo_list = self.GetDiscreteRSPoint(self.a_pc, self.e_pc, alt, AR, RE, a_E, e_E, "ground", N=cut_V)
  File "/home/bossel/These/Analysis/src/rayleigh/world.py", line 590, in GetDiscreteRSPoint
    alt = obs.GetPCoordinatesFromRange(r)[2]
  File "/home/bossel/These/Analysis/src/geomagic/observation.py", line 60, in GetPCoordinatesFromRange
    lon, lat = self.GetPCoordinates(AH = AH_vect)
  File "/home/bossel/These/Analysis/src/geomagic/observation.py", line 180, in GetPCoordinates
    P_lat = np.pi/2. - m.atan2(np.sqrt(OH[0][0]**2 + OH[1][0]**2), OH[2][0])
KeyboardInterrupt
